<!-- templates/loans/loan_application.html -->
{% extends 'base.html' %}
{% load static %}

{% block content %}
<div>
    <style>
        /* Modern Input Field Styles */
input, select, textarea {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid #e5e7eb;
    border-radius: 10px;
    background: #ffffff;
    font-size: 14px;
    font-weight: 500;
    color: #1f2937;
    transition: all 0.3s ease;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

/* Input with left icon */
input[type="number"] {
    padding-left: 70px;
}

/* Select dropdown styling */
select {
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 16px;
    padding-right: 40px;
}

/* Focus states */
input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: #10b981;
    background-color: #f9fafb;
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
    transform: translateY(-1px);
}

/* Hover states */
input:hover, select:hover, textarea:hover {
    border-color: #d1d5db;
    background-color: #f9fafb;
}

/* Placeholder styling */
input::placeholder {
    color: #9ca3af;
    font-weight: 400;
}

/* Disabled state */
input:disabled, select:disabled, textarea:disabled {
    background-color: #f3f4f6;
    color: #6b7280;
    border-color: #e5e7eb;
    cursor: not-allowed;
}

/* Error state */
input:invalid, select:invalid, textarea:invalid {
    border-color: #ef4444;
    background-color: #fef2f2;
}

/* Success state */
input:valid:not(:placeholder-shown), select:valid, textarea:valid:not(:placeholder-shown) {
    border-color: #10b981;
    background-color: #f0fdf4;
}

/* Number input specific */
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

input[type="number"] {
    -moz-appearance: textfield;
}

/* Select option styling */
select option {
    padding: 12px;
    background: white;
    color: #1f2937;
    font-size: 14px;
}

/* Label styling enhancement */
label {
    font-weight: 600;
    color: #374151;
}
    </style>

        <div class="bg-gradient-to-r from-purple-500 to-indigo-600 rounded-xl p-4 mb-4 flex items-center text-white">
                <div class="flex-1">
                    <h2 class="font-bold mb-2">loans</h2>
                    <p class="text-base mb-3">Kodi Ndinu Oyenera Kutenga Ngongole!</p>
                 
                </div>
                <div class="ml-4">
                    <img src="{% static 'money.png' %}" style="width: 130px;" alt="" >
                </div>
            </div>
            
    <h2 class="text-xl font-bold text-gray-900 mb-4">Apply for Loan</h2>
    
    <div class="glass-card p-4 mb-6">
        <form method="post" id="loanForm">
            {% csrf_token %}
            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-medium text-gray-700 mb-2">Loan Amount (MWK)</label>
                    <div class="relative">
                        {{ form.amount }}
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <span class="text-gray-500">MWK</span>
                        </div>
                    </div>
                </div>
                
                <div>
                    <label class="block text-xs font-medium text-gray-700 mb-2">Repayment Period (Months)</label>
                    {{ form.repayment_period }}
                </div>
                
                <div>
                    <label class="block text-xs font-medium text-gray-700 mb-2">Purpose</label>
                    {{ form.purpose }}
                </div>
                
                <button type="submit" class="w-full bg-green-500 text-white py-3 rounded-lg font-semibold text-sm hover:bg-green-600 transition-all duration-300 transform hover:scale-[1.02] shadow-lg">
                    Apply Now
                </button>
            </div>
        </form>
    </div>
    
    <!-- Loan Calculator -->
    <div class="glass-card p-4">
        <h3 class="text-base font-bold text-gray-900 mb-4">Loan Calculator</h3>
        <div class="space-y-4">
            <div class="flex justify-between text-xs text-gray-600">
                <span>Monthly Payment:</span>
                <span id="monthlyPayment" class="font-semibold text-gray-900">--</span>
            </div>
            <div class="flex justify-between text-xs text-gray-600">
                <span>Total Interest:</span>
                <span id="totalInterest" class="font-semibold text-gray-900">--</span>
            </div>
            <div class="flex justify-between text-xs text-gray-600">
                <span>Total Repayment:</span>
                <span id="totalRepayment" class="font-semibold text-gray-900">--</span>
            </div>
        </div>
    </div>
</div>
{% endblock content %}

{% block extra_scripts %}
<script>
    // Loan Calculator
    const loanAmountInput = document.querySelector('input[name="amount"]');
    const repaymentPeriodInput = document.querySelector('input[name="repayment_period"]');
    const purposeSelect = document.querySelector('select[name="purpose"]');
    const interestRate = 0.15;

    function calculateLoan() {
        const amount = parseFloat(loanAmountInput.value) || 0;
        const months = parseInt(repaymentPeriodInput.value) || 0;

        if (amount > 0 && months > 0) {
            const monthlyRate = interestRate / 12;
            const monthlyPayment = (amount * monthlyRate * Math.pow(1 + monthlyRate, months)) / 
                                  (Math.pow(1 + monthlyRate, months) - 1);
            const totalRepayment = monthlyPayment * months;
            const totalInterest = totalRepayment - amount;

            document.getElementById('monthlyPayment').textContent = 'MWK ' + monthlyPayment.toFixed(0);
            document.getElementById('totalInterest').textContent = 'MWK ' + totalInterest.toFixed(0);
            document.getElementById('totalRepayment').textContent = 'MWK ' + totalRepayment.toFixed(0);
        } else {
            document.getElementById('monthlyPayment').textContent = '--';
            document.getElementById('totalInterest').textContent = '--';
            document.getElementById('totalRepayment').textContent = '--';
        }
    }

    loanAmountInput.addEventListener('input', calculateLoan);
    repaymentPeriodInput.addEventListener('change', calculateLoan);

    // Initialize calculator
    calculateLoan();
</script>
{% endblock extra_scripts %}